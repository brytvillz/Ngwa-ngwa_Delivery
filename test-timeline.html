<!doctype html>
<html>
  <head>
    <title>Timeline Test</title>
    <style>
      body {
        font-family: Arial;
        padding: 20px;
        background: #f5f5f5;
      }
      .result {
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 10px 0;
      }
      .timeline {
        background: #e8f5e9;
        padding: 10px;
        margin: 10px 0;
        border-left: 4px solid #4caf50;
      }
      .no-timeline {
        background: #fff3cd;
        padding: 10px;
        margin: 10px 0;
        border-left: 4px solid #ff9800;
      }
      pre {
        background: #f5f5f5;
        padding: 10px;
        overflow-x: auto;
      }
    </style>
  </head>
  <body>
    <h1>üîç Timeline Feature Test</h1>
    <div id="results"></div>

    <script>
      const bookings = JSON.parse(
        localStorage.getItem("ngwangwa_bookings") || "[]",
      );
      const resultsDiv = document.getElementById("results");

      if (bookings.length === 0) {
        resultsDiv.innerHTML = `
                <div class="result">
                    <h2>‚ùå No Bookings Found</h2>
                    <p>Create a booking first on <a href="index.html">index.html</a></p>
                </div>
            `;
      } else {
        resultsDiv.innerHTML = `<h2>Found ${bookings.length} booking(s):</h2>`;

        bookings.forEach((booking, index) => {
          const hasTimeline = booking.timeline && booking.timeline.length > 0;
          const hasEstimatedTime = booking.estimatedDeliveryTime;
          const hasDeliveredTime = booking.deliveredTime;

          resultsDiv.innerHTML += `
                    <div class="result">
                        <h3>Booking ${index + 1}: ${booking.referenceId}</h3>
                        <p><strong>Status:</strong> ${booking.status}</p>
                        <p><strong>Customer:</strong> ${booking.customerName}</p>
                        
                        ${
                          hasTimeline
                            ? `
                            <div class="timeline">
                                <h4>‚úÖ Timeline Exists (${booking.timeline.length} entries)</h4>
                                <pre>${JSON.stringify(booking.timeline, null, 2)}</pre>
                            </div>
                        `
                            : `
                            <div class="no-timeline">
                                <h4>‚ö†Ô∏è No Timeline Yet</h4>
                                <p>Go to <a href="admin.html">admin.html</a> and change the status to create timeline entries</p>
                            </div>
                        `
                        }
                        
                        ${
                          hasEstimatedTime
                            ? `
                            <p>üìÖ <strong>Estimated Delivery:</strong> ${new Date(booking.estimatedDeliveryTime).toLocaleString()}</p>
                        `
                            : ""
                        }
                        
                        ${
                          hasDeliveredTime
                            ? `
                            <p>‚úÖ <strong>Delivered At:</strong> ${new Date(booking.deliveredTime).toLocaleString()}</p>
                        `
                            : ""
                        }
                        
                        <p><a href="tracking.html">Test on Tracking Page ‚Üí</a></p>
                    </div>
                `;
        });
      }
    </script>
  </body>
</html>
